<!DOCTYPE html>
<html>

<head>
  <title>BPRAXIS HS18 Heatmap</title>
  <link rel="stylesheet" type="text/css" href="dist/calendar-heatmap.min.css">
</head>

<body>
  <h1>
    <font face="verdana" color="black">Has the BPRAXIS Module HS18 been evaluated yet?</font>
  </h1>
  <br>
  <div id="calendar"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.10.2/d3.min.js" charset="utf-8"></script>
  <script src="dist/calendar-heatmap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>
  
  <script type="text/javascript">
  $(document).ready(function(){
	$('#header').load('../header-ads.html');
    $('#footer').load('../footer-ads.html');
	
	var data;
	$.ajax({
	  type: "GET",  
    url: "https://daveschafer.github.io/BPRAXIS_Heatmap/bpraxis_data.csv",
	  dataType: "text",       
	  success: function(response)  
	  {
		data = $.csv.toArrays(response);
		generateHtmlTable(data);
	  }   
	});
	
	function generateHtmlTable(data) {
		var html = '<table  class="table table-condensed table-hover table-striped">';

      if(typeof(data[0]) === 'undefined') {
        return null;
      } else {
		$.each(data, function( index, row ) {
		  //bind header
		  if(index == 0) {
			html += '<thead>';
			html += '<tr>';
			$.each(row, function( index, colData ) {
				html += '<th>';
				html += colData;
				html += '</th>';
			});
			html += '</tr>';
			html += '</thead>';
			html += '<tbody>';
		  } else {
			html += '<tr>';
			$.each(row, function( index, colData ) {
				html += '<td>';
				html += colData;
				html += '</td>';
			});
			html += '</tr>';
		  }
		});
		html += '</tbody>';
		html += '</table>';
		
		$('#csv-display').append(html);
	  }
	}
  });
  </script>

  <script>
    (function () {
      // Initialize random data for the demo
      var now = moment().endOf('day').toDate();
      var time_ago = moment().startOf('day').subtract(10, 'year').toDate();

      var sourceJSON = csvJSON()
      console.info("Hello There");
      console.info(csvJSON());

      var m_data = [{
        "date": sourceJSON.date,
        "total": sourceJSON.total,
        "details": [{
          "name": sourceJSON.name,
          "value": sourceJSON.value
        }]
      }]

      /*[{
          "date": "2019-01-01",
          "total": 900,
          "details": [{
            "name": "Published? NO!",
            "value": 0
          }]
        },{ 
          "date": "2019-01-02",
          "name": "test",
          "total": 200,
          "details": [{
            "name": "Published? NO!",
            "value": 0
          }]
        },{ 
          "date": "2019-01-04",
          "total": 250,
          "details": [{
            "name": "FS19 now online...",
            "value": 0
          }]
        }, {
          "date": "2019-02-06",
          "total": 200,
          "details": [{
            "name": "Published? NO!",
            "value": 0
          }]
        }      
      ]*/

      // Set the div target id
      var div_id = 'calendar';

      // Set custom color for the calendar heatmap
      // var color = '#cd2327';
      var color = '#4894c4';

      // Set overview type (choices are year, month and day)
      var overview = 'year';

      // Handler function
      var print = function (val) {
        console.log(val);
      };

      // Initialize calendar heatmap
      calendarHeatmap.init(m_data, div_id, color, overview, print);
      calendarHeatmap.init()
    })();
  </script>
</body>

</html>